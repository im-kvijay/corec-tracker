name: Retry Failed Collect

on:
  workflow_run:
    workflows: ["Collect CoRec Data"]
    types: [completed]

jobs:
  retry:
    if: github.event.workflow_run.conclusion == 'failure'
    runs-on: ubuntu-22.04
    timeout-minutes: 2

    steps:
      - name: Retry failed workflow
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "Retrying failed Collect CoRec Data run..."
          gh workflow run "Collect CoRec Data" --repo ${{ github.repository }}
